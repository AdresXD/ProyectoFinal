<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layout/layout :: head }"></head>
<div th:replace="~{layout/layout:: nuevo}"></div>
<body class="bg-stone-900 text-stone-100 flex flex-col items-center min-h-screen w-screen">
<header th:replace="~{layout/layout :: header}"></header>

<div class="w-full min-h-screen flex flex-col items-center pt-32 px-6">
    <h1 class="text-4xl font-bold text-yellow-100 mb-10 font-['Poppins']">[[${Title}]]</h1>

    <section class="w-full flex flex-col items-center gap-10">
        <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl flex flex-col items-center md:flex-row md:items-start gap-6" th:each="habitacion : ${habitaciones}">

            <div class="flex flex-col gap-2 text-stone-800">
                <p class="text-lg font-bold">ver Convocatoria: [[${Convocatoria.Idconvocatoria}]]</p>
                <h2 class="text-2xl font-semibold">[[${Convocatoria.nombre}]]</h2>
                <p class="text-sm">
                    Capacity:
                    <span th:if="${Convocatoria.descripcion}"> Write details</span>

                </p>
                <p class="text-lg font-bold text-blue-500">Lugar: $[[${Convocatoria.lugar}]]</p>
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h2 class="text-xl font-bold text-white">[[${convocatoria.titulo}]]</h2>
                    <p class="text-sm text-stone-300">Fecha: <span th:text="${#dates.format(convocatoria.fecha, 'dd/MM/yyyy')}"></span></p>
                    <p class="text-sm text-stone-300">Hora: <span th:text="${#dates.format(convocatoria.hora, 'HH:mm')}"></span></p>
                </div>


                <!-- Botones -->
                <div class="mt-4 flex gap-3">
                    <a th:href="@{/modificar/{id}(id=${Convocatoria.idConvocatoria})}"
                       class="bg-amber-700 text-white px-4 py-2 rounded-lg hover:bg-amber-500 transition-all"
                       sec:authorize="hasRole('ADMINISTRADOR')">Edit</a>

                    <form th:action="@{/eliminarHab/{id}(id=${convocatoria.idConvocatoria})}" method="post"
                          onsubmit="return confirmarEliminacion(event,this);">
                        <button type="submit"
                                class="bg-red-800 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-all"
                                sec:authorize="hasRole('ADMINISTRADOR')">Delete</button>
                    </form>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Toast de Ã©xito -->
<div id="toast-exito"
     class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-xl shadow-xl transition-opacity duration-300 opacity-0 z-50 text-lg font-semibold"
     th:if="${mensajeExito}" th:text="${mensajeExito}"></div>

<!-- Scripts -->
<script>
    window.addEventListener("DOMContentLoaded", function () {
        const toast = document.getElementById("toast-exito");
        if (toast) {
            toast.classList.remove("opacity-0");
            toast.classList.add("opacity-100");
            setTimeout(() => {
                toast.classList.remove("opacity-100");
                toast.classList.add("opacity-0");
            }, 3000);
        }
    });
</script>

<script src="http://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        let successMessage = "[[${success}]]";
        if (successMessage && successMessage !== "null" && successMessage.trim() !== "") {
            swal.fire({
                icon: "success",
                title: "Success",
                text: successMessage
            });
        }

        let errorMessage = "[[${error}]]";
        if (errorMessage && errorMessage !== "null" && errorMessage.trim() !== "") {
            swal.fire({
                icon: "error",
                title: "Error",
                text: errorMessage
            });
        }
    });

    function confirmarEliminacion(event, form) {
        event.preventDefault();
        Swal.fire({
            title: "Are you sure?",
            text: "This action cannot be undone",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#a61717",
            cancelButtonColor: "#e59816",
            confirmButtonText: "Yes, delete",
            cancelButtonText: "Cancel"
        }).then((result) => {
            if (result.isConfirmed) {
                form.submit();
            }
        });
    }
</script>

<footer class="mt-10" th:replace="~{layout/layout :: footer}"></footer>
</body>
</html>